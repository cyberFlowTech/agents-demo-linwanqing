# 🚀 林晚晴 AI - 快速启动指南

## ✅ 已完成的工作

林晚晴现在是一个**活生生的心理咨询师AI**，不再是只会执行命令的程序！

---

## 📋 功能清单

- ✅ **完整人设系统**（32岁心理咨询师，理性温柔）
- ✅ **私聊对话功能**（可以直接聊天）
- ✅ **群组@回复功能**（在群里@她会回复）
- ✅ **对话历史管理**（保存最近10轮）
- ✅ **与塔罗功能整合**（保持人设一致性）
- ✅ **OpenAI API 集成**
- ✅ **专业边界管理**（不制造依赖）

---

## 🔧 配置步骤

### 1. 安装依赖
```bash
pip install openai
```

### 2. 配置 OpenAI API
编辑 `.env` 文件，添加：

```bash
# ===== OpenAI 配置 =====
OPENAI_API_KEY=sk-your_api_key_here
OPENAI_BASE_URL=                    # 可选：国内中转地址
OPENAI_MODEL=gpt-4o-mini            # 推荐：性价比高
```

**模型选择**:
- `gpt-4o-mini`: 推荐，性价比高，速度快
- `gpt-4o`: 能力更强，更贵
- `gpt-3.5-turbo`: 便宜，但能力稍弱

### 3. 启动 Bot
```bash
python main.py
```

---

## 🎮 如何使用

### 私聊对话
直接给 Bot 发消息，不需要命令：

```
你: 我最近工作压力很大

林晚晴: 工作压力大是现代人很常见的困扰。
能具体说说，是什么让你感到压力吗？是工作量、
人际关系，还是对自己的期待？...
```

### 群组@回复
在群组中@林晚晴：

```
你: @林晚晴 塔罗准吗？

林晚晴: @你 塔罗不是预测未来的工具，而是一面
镜子，帮你看清内心的状态和潜在的可能性...
```

### 新增命令

| 命令 | 功能 |
|------|------|
| `/intro` 或 `/about` | 了解林晚晴是谁 |
| `/clear` | 清除对话历史 |
| `/start` | 林晚晴的欢迎语（已更新） |
| `/help` | 查看所有功能（已更新） |

---

## 🎭 林晚晴是谁

### 基本信息
- **姓名**: 林晚晴（Elena Lin）
- **年龄**: 32岁
- **职业**: 心理咨询师（主业）+ 塔罗工具（辅助）
- **现居**: 上海
- **学历**: 复旦大学心理学硕士

### 核心理念
- "塔罗揭示的是趋势，而不是命令"
- "真正的选择权，始终在你手中"
- 不算命，只做心理对话工具

### 性格特点
- 温柔但有边界
- 理性而不冷漠
- 鼓励自我负责
- 不制造依赖

---

## 📊 测试场景

### 测试1: 私聊对话
```
你: 你好
你: 我最近很焦虑
你: 不知道该怎么办
```

**预期**: 林晚晴会倾听、共情、引导你具体化问题

### 测试2: 塔罗占卜
```
你: /tarot 我应该换工作吗
（完成占卜后）
你: 那我接下来该怎么做
```

**预期**: 林晚晴会结合占卜结果，给出具体建议

### 测试3: 群组@
```
在群组中: @林晚晴 你是谁
```

**预期**: 简短自我介绍，保持专业友好

### 测试4: 清除历史
```
你: /clear
```

**预期**: 对话历史被清空，可以重新开始

---

## 🔍 故障排查

### 问题1: OpenAI API 错误
**症状**: 回复 "抱歉，我现在有些状态不好..."

**解决**:
1. 检查 `OPENAI_API_KEY` 是否正确
2. 检查 API 额度是否充足
3. 如果使用中转，检查 `OPENAI_BASE_URL` 是否正确

### 问题2: 不回复消息
**症状**: 发消息没有反应

**解决**:
1. 确保不是以 `/` 开头（命令不会触发对话）
2. 检查 Bot 是否启动成功
3. 查看终端日志是否有错误

### 问题3: 群组不回复
**症状**: 在群里@Bot 没反应

**解决**:
1. 确保@了正确的 Bot username
2. 检查 Bot 是否有群组权限
3. 查看日志中是否检测到@消息

---

## 📂 核心文件说明

### 新增文件
```
services/ai_chat.py          # AI对话核心服务
handlers/chat.py             # 对话处理器（私聊+群组）
docs/ELENA_AI_SYSTEM.md      # 完整文档
```

### 修改文件
```
config.py                    # 新增 OpenAI 配置
.env.example                 # 新增 OpenAI 配置示例
main.py                      # 注册对话处理器，更新欢迎语
```

---

## 💡 使用技巧

### 1. 对话历史
- 私聊会保存最近10轮对话
- 群组不保存历史（避免混乱）
- 随时使用 `/clear` 清除历史

### 2. 最佳实践
- 具体描述问题，而非泛泛而谈
- 可以多轮对话，深入探讨
- 结合塔罗占卜使用效果更好

### 3. 场景组合
```
# 完整流程示例
1. 先聊天了解问题
2. 使用 /tarot 占卜
3. 继续聊天讨论结果
4. 获得行动建议
```

---

## 🎉 开始使用

### 1. 启动 Bot
```bash
python main.py
```

### 2. 私聊测试
给 Bot 发送任意消息（不是命令）

### 3. 查看介绍
```
/intro
```

### 4. 开始聊天
像和真人聊天一样，分享你的困惑

---

## 🌟 核心优势

### 之前
- ❌ 只能执行命令
- ❌ 冷冰冰的程序
- ❌ 没有人格魅力

### 现在
- ✅ 可以自由对话
- ✅ 有温度的AI角色
- ✅ 专业的心理咨询师人设
- ✅ 保持边界和专业性

---

## 📞 技术支持

如果遇到问题：
1. 查看 `docs/ELENA_AI_SYSTEM.md` 完整文档
2. 检查终端日志输出
3. 确认 OpenAI API 配置正确

---

## 🎊 总结

林晚晴，一个**温柔、理性、有边界**的心理咨询师AI，已经准备好了！

**她不只是一个塔罗占卜程序，而是一个可以陪你聊天、帮你看清选择的AI伙伴。** 🌙✨

现在就启动 Bot，和林晚晴聊聊吧！
