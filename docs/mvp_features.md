# 群组社交化 MVP 功能文档

## 🎯 MVP 目标

让塔罗占卜机器人从"工具"变成"社交游戏"，在群组中激发互动，提升用户活跃度和留存率。

## ✨ 已实现功能

### 1. 🌅 群日运势播报

**命令**: `/group_fortune`

**功能说明**:
- 每个群每天生成唯一的群运势
- 包含主牌、副牌、运势指数(1-5星)
- 推荐当日适合/避免的活动
- 显示今日参与占卜的人数

**使用场景**:
- 群管理员每天早上发送，激活群氛围
- 群成员随时查看今日群运势
- 作为每日话题的引子

**示例输出**:
```
━━━━━━━━━━━━━━━━━
🌅 群日运势播报 🌅
━━━━━━━━━━━━━━━━━

📅 2026年02月12日 星期三
🏰 产品讨论群

━━━━━━━━━━━━━━━━━

🔮 今日塔罗气象
   主牌：太阳(正位)
   副牌：星星(正位)

📊 运势指数：⭐⭐⭐⭐⭐ 5/5

💭 运势概述
运势极佳，万事顺遂！

━━━━━━━━━━━━━━━━━

✅ 今日适合
   • 开展新项目
   • 团队协作
   • 创意讨论

❌ 今日避免
   • 消极情绪
   • 过度焦虑

━━━━━━━━━━━━━━━━━

👥 已有 23 人抽取今日运势

💡 使用 /tarot [问题] 抽取你的个人运势
🏆 使用 /ranking 查看群运势排行榜

[🎴 抽取我的运势] [🏆 查看排行榜]
```

**产品价值**:
- ✅ 每日固定内容，养成打开习惯
- ✅ 群共同话题，增加讨论
- ✅ 数据可视化，制造期待感
- ✅ 引导个人占卜，增加使用频次

---

### 2. 🏆 群运势排行榜

**命令**: `/ranking`

**功能说明**:
- 自动记录群内所有人的占卜结果
- 按正位牌数量排序
- 显示前10名及其牌面
- 实时更新，随时可查

**触发机制**:
- 在群里使用 `/tarot [问题]` 占卜后，结果自动加入排行榜
- 无需额外操作，完全自动化

**使用场景**:
- 群成员查看自己今天的运势排名
- 围观谁今天运势最好
- 制造竞争和讨论话题

**示例输出**:
```
━━━━━━━━━━━━━━━━━
🏆 今日群运势排行榜 🏆
━━━━━━━━━━━━━━━━━

📅 2026年02月12日
🏰 产品讨论群

━━━━━━━━━━━━━━━━━

👑 张三 - 3张正位
   🎴 🎴 🎴

🥈 李四 - 2张正位
   🎴 🎴

🥉 王五 - 2张正位
   🎴 🎴

4. 赵六 - 1张正位
   🎴

5. 孙七 - 1张正位
   🎴

━━━━━━━━━━━━━━━━━

📊 共 18 人参与

💡 使用 /tarot [问题] 参与排行
```

**产品价值**:
- ✅ 可视化排名，激发竞争欲
- ✅ 社交认同，希望排名靠前
- ✅ 多次占卜，提升活跃度
- ✅ 群内话题，增加互动

---

### 3. ⚔️ 塔罗PK对战

**命令**: `/pk` (回复对手的消息)

**功能说明**:
- 1v1 塔罗对决
- 双方同时抽三张牌
- 计算能量值（正位30分，逆位15分）
- 比拼分数，决出胜负
- 记录战绩和胜率

**使用场景**:
- 好友互动，增进感情
- 其他人围观，制造话题
- 比赛形式，趣味十足

**操作流程**:
```
1. 张三回复李四的消息，输入 /pk
   ↓
2. 机器人发送挑战消息，显示两个按钮
   [✅ 接受挑战] [❌ 拒绝]
   ↓
3. 李四点击"接受挑战"
   ↓
4. 双方自动抽牌，比拼能量值
   ↓
5. 显示详细结果和大师点评
```

**示例输出**:
```
━━━━━━━━━━━━━━━━━
⚔️ 塔罗对决结果 ⚔️
━━━━━━━━━━━━━━━━━

👤 张三 VS 李四

━━━━━━━━━━━━━━━━━

🎴 张三 的牌：
   • 太阳(正位)
   • 星星(正位)
   • 世界(正位)
💪 能量值: 90分

🎴 李四 的牌：
   • 恶魔(逆位)
   • 月亮(正位)
   • 高塔(逆位)
💪 能量值: 60分

━━━━━━━━━━━━━━━━━

🏆 胜者：张三

🔮 塔罗大师点评
张三的牌阵能量远超对手，
运势正盛，势不可挡！

[🔁 再战一局] [📊 我的战绩]
```

**战绩查询**:
点击"📊 我的战绩"按钮显示：
```
━━━━━━━━━━━━━━━━━
📊 张三 的战绩
━━━━━━━━━━━━━━━━━

⚔️ 总场次：12场
✅ 胜利：8场
❌ 失败：4场
📈 胜率：66.7%

⚔️ 实力强劲，继续加油！
```

**产品价值**:
- ✅ 好友互动，增加社交粘性
- ✅ 胜负机制，趣味性强
- ✅ 战绩记录，长期激励
- ✅ 围观效应，带动参与

---

## 🎮 功能联动

### 完整的群组使用流程

```
早上9点
  ↓
群管理员发送 /group_fortune
  ↓
群成员看到今日运势
  ↓
部分人开始 /tarot 占卜
  ↓
结果自动进入排行榜
  ↓
有人查看 /ranking
  ↓
发现自己运势不错
  ↓
@好友炫耀，并发起 /pk
  ↓
好友接受挑战
  ↓
其他人围观讨论
  ↓
更多人参与占卜和PK
  ↓
群活跃度大幅提升
```

---

## 📊 数据存储

### 数据文件结构

所有数据存储在 `data/` 目录：

**1. groups.json** - 群运势数据
```json
{
  "group_123": {
    "fortune_date": "2026-02-12",
    "fortune": {
      "main_card": {"name": "太阳(正位)"},
      "sub_card": {"name": "星星(正位)"},
      "stars": 5,
      "summary": "运势极佳"
    }
  }
}
```

**2. rankings.json** - 排行榜数据
```json
{
  "group_123": {
    "2026-02-12": [
      {
        "user_id": "user1",
        "user_name": "张三",
        "positive_count": 3,
        "cards": ["太阳(正)", "星星(正)", "世界(正)"],
        "timestamp": "2026-02-12T10:30:00"
      }
    ]
  }
}
```

**3. pk_records.json** - PK记录数据
```json
{
  "group_123": [
    {
      "timestamp": "2026-02-12T11:00:00",
      "user1": {
        "id": "user1",
        "name": "张三",
        "score": 90
      },
      "user2": {
        "id": "user2",
        "name": "李四",
        "score": 60
      },
      "winner_id": "user1"
    }
  ]
}
```

---

## 🚀 快速开始

### 1. 启动机器人

```bash
python3 main.py
```

### 2. 将机器人添加到群组

在 Telegram 中：
1. 找到你的机器人
2. 点击"添加到群组"
3. 选择目标群组

### 3. 在群里试用

```
# 查看帮助
/help

# 群日运势
/group_fortune

# 个人占卜（自动加入排行榜）
/tarot 我今天运势如何？

# 查看排行榜
/ranking

# 发起PK（回复对手消息）
/pk
```

---

## 💡 运营建议

### 每日运营节奏

**早上 9:00-10:00**
- 发送群日运势 `/group_fortune`
- 引导："看看今天咱们群运势如何"

**中午 12:00-13:00**
- 发送排行榜 `/ranking`
- 引导："午休看看谁今天运势最好"

**晚上 20:00-21:00**
- 发起PK活动
- 引导："晚上好，来PK一局放松一下"

**睡前 22:00-23:00**
- 总结今日排行
- 预告明天运势

### 活动玩法

**周一：事业运PK**
- 主题：谁的事业运最旺
- 引导大家占卜事业相关问题

**周五：周末运势预测**
- 主题：周末有什么好运气
- 增加参与感和期待感

**月度冠军**
- 统计本月排行榜第一次数最多的人
- 授予"月度运势之王"称号

---

## 📈 预期效果

### 关键指标提升预期

| 指标 | 当前 | MVP后 | 提升 |
|------|------|-------|------|
| 群DAU | 10% | 40% | +300% |
| 日均消息数 | 20条 | 80条 | +300% |
| 人均使用次数 | 0.2次 | 1.5次 | +650% |
| 用户留存(7日) | 15% | 45% | +200% |

### 用户行为变化

**之前**:
- 偶尔想起来占卜一次
- 占卜完就走
- 没有群内互动
- 占卜结果私人保存

**之后**:
- 每天固定查看群运势
- 参与排行榜竞争
- 和好友PK互动
- 在群里讨论结果

---

## 🔄 后续迭代方向

### 第二期功能

1. **自动定时播报**
   - 每天自动发送群运势
   - 无需手动触发

2. **每周总结**
   - 统计本周运势之王
   - 生成群运势周报

3. **成就系统**
   - 连续占卜奖励
   - 排行榜连冠奖励
   - PK连胜奖励

### 第三期功能

1. **群塔罗接龙**
   - 多人协作占卜
   - 形成群命运故事

2. **塔罗剧本杀**
   - 3-5人组队玩法
   - 根据牌面生成剧本

3. **跨群PK**
   - 群与群之间对战
   - 扩大影响力

---

## 🎯 总结

通过这三个核心功能，我们实现了：

✅ **从工具到游戏** - 占卜变成有趣的社交活动
✅ **从个人到群组** - 私密体验变成公开互动
✅ **从一次性到持续** - 单次使用变成每日习惯
✅ **从旁观到参与** - 被动接受变成主动竞争

**MVP的核心价值**: 用最小的开发成本，验证群组社交化的可行性，为后续迭代提供数据支持。
