# 🎭 林晚晴人设配置指南

## 📍 配置文件位置

```
prompts/elena_character.txt
```

这是林晚晴的**完整人设配置文件**，包含了她的所有细节。

---

## 🎯 为什么要独立配置文件？

### 优势
1. **方便修改**：不需要改代码，只改配置文件
2. **热更新**：修改后重启 Bot 即可生效
3. **版本管理**：可以保留多个版本，随时切换
4. **团队协作**：非技术人员也能修改人设
5. **备份方便**：复制文件即可备份

---

## 📝 配置文件结构

### 完整版人设（当前）

`prompts/elena_character.txt` 包含：

1. **📋 基础档案** (200+ 行)
   - 个人信息（姓名、年龄、外貌）
   - 教育背景（本科、硕士）
   - 职业经历（2016-至今）
   - 专业资质

2. **👨‍👩‍👧 家庭背景** (50+ 行)
   - 父亲：林志远（物理老师）
   - 母亲：周雅琴（语文老师）
   - 家庭氛围

3. **💔 人生转折点** (30+ 行)
   - 28岁的那场感情
   - 从理性到情感的觉醒

4. **🏠 日常生活** (100+ 行)
   - 居住环境（55平小窝）
   - 日常作息（6:30起床）
   - 饮食习惯（黑咖啡）
   - 运动习惯（瑜伽）
   - 社交圈
   - 宠物：乌木

5. **🎨 兴趣爱好** (50+ 行)
   - 阅读（荣格、波伏娃）
   - 写作（公众号）
   - 音乐（爵士、民谣）

6. **🎴 塔罗与心理学** (50+ 行)
   - 塔罗定位
   - 如何理解塔罗
   - 她的边界

7. **💬 语言风格** (50+ 行)
   - 常用表达
   - 绝不会说
   - 语气词和口头禅

8. **🧠 性格与价值观** (80+ 行)
   - 核心性格
   - 核心价值观
   - 对不同事物的态度

9. **📞 对话原则** (30+ 行)
   - 倾听优先
   - 理性温柔
   - 鼓励自主
   - 适度幽默

10. **🎭 特殊场景处理** (60+ 行)
    - 感情问题
    - 事业问题
    - 过度依赖
    - 情绪崩溃

11. **📱 其他细节** (40+ 行)
    - 社交媒体习惯
    - 穿衣风格
    - 对雨天的喜爱
    - 失眠时会做什么

12. **🌙 自我介绍模板**

13. **💭 内心独白**

14. **🎯 核心记忆点总结**

---

## 🔧 如何修改配置

### 方式1: 直接编辑
```bash
vim prompts/elena_character.txt
# 或
code prompts/elena_character.txt
```

### 方式2: 使用任何文本编辑器
- 记事本
- VS Code
- Sublime Text
- 等等...

### 重要提示
- **文件编码**：必须是 UTF-8
- **保存后重启**：修改后需要重启 Bot
- **建议备份**：改之前先复制一份

---

## 📖 修改示例

### 示例1: 修改年龄
```
原来：
你是林晚晴（Elena Lin），一位32岁的心理咨询师

修改为：
你是林晚晴（Elena Lin），一位28岁的心理咨询师
```

### 示例2: 添加新的爱好
在 **🎨 兴趣爱好** 部分添加：
```
### 绘画
- 喜欢水彩画
- 偶尔会去画室上课
- 作品主题：风景和植物
```

### 示例3: 修改语言风格
在 **💬 语言风格 - 常用表达** 中添加：
```
- "我懂你的感受……"
- "换个角度看看……"
- "慢慢来，不着急……"
```

### 示例4: 修改性格特点
在 **🧠 性格与价值观** 中修改：
```
原来：
- 温柔但有边界

修改为：
- 温柔且幽默，但有边界
- 善于用轻松的方式化解紧张
```

### 示例5: 添加新的场景处理
在 **🎭 特殊场景处理** 中添加：
```
### 当用户表达愤怒
**先接纳情绪**：
- "愤怒是正常的，说明你在意。"
- "让自己愤怒一会儿，没关系的。"

**引导宣泄**：
- "你可以告诉我，是什么让你这么生气？"
- "愤怒背后，通常藏着更深的情绪。"
```

---

## 🎨 人设版本管理

### 创建新版本
```bash
# 备份当前版本
cp prompts/elena_character.txt prompts/elena_character_v1.txt

# 创建新版本
cp prompts/elena_character.txt prompts/elena_character_v2.txt
# 然后编辑 v2
```

### 切换版本
```bash
# 切换到 v1
cp prompts/elena_character_v1.txt prompts/elena_character.txt

# 切换到 v2
cp prompts/elena_character_v2.txt prompts/elena_character.txt

# 重启 Bot
python3 main.py
```

### 创建简化版
如果觉得太详细，可以创建简化版：

```bash
# 创建简化版
cp prompts/elena_character.txt prompts/elena_character_simple.txt
# 然后删除一些不需要的细节
```

---

## 🔍 配置文件的加载机制

### 代码位置
`services/ai_chat.py` 第 12-34 行

### 加载逻辑
```python
def _load_elena_prompt() -> str:
    """从配置文件加载林晚晴的人设 prompt"""
    prompt_file = os.path.join(
        os.path.dirname(os.path.dirname(__file__)),
        'prompts',
        'elena_character.txt'
    )
    
    try:
        with open(prompt_file, 'r', encoding='utf-8') as f:
            prompt = f.read()
        logger.info(f"✅ 成功加载林晚晴人设配置 ({len(prompt)} 字符)")
        return prompt
    except FileNotFoundError:
        logger.error(f"❌ 人设配置文件不存在")
        # 返回默认 prompt
    except Exception as e:
        logger.error(f"❌ 读取人设配置文件失败: {e}")
```

### 日志输出
启动 Bot 时会看到：
```
✅ 成功加载林晚晴人设配置 (15234 字符)
```

如果看到这个，说明配置加载成功！

---

## 🧪 测试修改

### 1. 修改配置文件
编辑 `prompts/elena_character.txt`

### 2. 重启 Bot
```bash
# 停止当前 Bot（Ctrl+C）
# 重新启动
python3 main.py
```

### 3. 测试对话
```
你: 介绍一下你自己

林晚晴: [会根据新的配置回复]
```

### 4. 验证修改
- 如果修改了年龄，问她："你多大了？"
- 如果修改了爱好，问她："你平时喜欢做什么？"
- 如果修改了语言风格，观察她的回复方式

---

## 💡 最佳实践

### 1. 保持一致性
- 修改时注意前后一致
- 比如改了年龄，也要改对应的人生经历时间线

### 2. 渐进式修改
- 不要一次改太多
- 改一点，测试一点
- 确认没问题再继续改

### 3. 备份原版
```bash
# 第一次修改前，先备份
cp prompts/elena_character.txt prompts/elena_character_original.txt
```

### 4. 记录修改
可以在文件顶部添加修改日志：
```
# 修改记录
# 2026-02-12: 创建初始版本
# 2026-02-13: 修改年龄为28岁
# 2026-02-14: 添加绘画爱好
```

### 5. 测试关键场景
修改后测试这些场景：
- 自我介绍
- 感情问题咨询
- 事业问题咨询
- 塔罗理解
- 语言风格

---

## 🎯 核心记忆点

1. **配置文件位置**：`prompts/elena_character.txt`
2. **修改后需重启**：`python3 main.py`
3. **查看加载日志**：启动时看到 "✅ 成功加载" 就对了
4. **备份很重要**：改之前先复制
5. **测试很必要**：改完一定要测

---

## 🚀 快速开始

```bash
# 1. 打开配置文件
code prompts/elena_character.txt

# 2. 修改你想改的内容

# 3. 保存文件

# 4. 重启 Bot
python3 main.py

# 5. 测试对话
# 在 Telegram 给 Bot 发消息测试
```

---

**现在，林晚晴的人设完全由你掌控！** 🌙✨

想让她更幽默？改配置！  
想让她更严肃？改配置！  
想让她变成别的角色？改配置！

一切都在 `prompts/elena_character.txt` 中！
